# 1. 脚本开头
## 1.1  shebang解释器

```
#!/bin/bash      #Bash
#!/bin/sh        #BourneShell
#!/usr/bin/pwsh  #PowerShell
#!/usr/bin/perl  #Per
#!/usr/bin/tcl   #TCL
#!/usr/bin/sed -f
#!/usr/bin/awk -f
#!/usr/bin/python3
#!/usr/bin/env python3
```
## 1.2 解释器选项

-  -e 当脚本发生第一个错误时, 就退出脚本, 换种说法就是, 当一个命令返回
非零值时, 就退出脚本;
-  -x 与-v选项类似, 但是会打印完整命令
-  -f  禁用Bash扩展
# 2. 注释
## 2.1 单行注释

```
#注释1
#注释2
```
## 2.2 多行注释

```
:<<EOF
注释1
注释2
EOF
```
# 3. 命令格式及操作符

## 3.1 基础格式

```
command [arg1 ... [argN]]
```

`command`是具体的命令或者一个可执行文件，`arg1 ... argN`是传递给命令的参数，它们是可选的。

```
ls -l
```

`ls`是命令,`-l`是参数
## 3.2 空格和TAB

Bash 使用空格（或 Tab 键）分割命令和参数。
如果参数之间有多个空格，Bash 会自动忽略多余的空格。
## 3.3 反斜杠（`\`）

Bash 单个命令一般都是一行，用户按下回车键，就开始执行。有些命令比较长，写成多行会有利于阅读和编辑，这时可以在每一行的结尾加上反斜杠，Bash 就会将下一行跟当前行放在一起解释。

```
./config --prefix=/usr/local/openssl \
--with-zlib-lib=/usr/local/zlib/lib \
--with-zlib-include=/usr/local/zlib/include \
enable-md2 \
shared
```

## 3.4 分号 `;`

分号（`;`）是命令的结束符，使得一行可以放置多个命令，上一个命令执行结束后，再执行第二个命令。

```
clear ; ls -l
```

>[!IMPORTANT]
>使用分号时，第二个命令总是接着第一个命令执行，不管第一个命令执行成功或失败

## 3.5 命令组合符号 `&&`和`||`

除了分号，Bash 还提供两个命令组合符`&&`和`||`，允许更好地控制多个命令之间的继发关系。

```
Command1 && Command2
```

上面命令的意思是，如果`Command1`命令运行成功，则继续运行`Command2`命令。

```
Command1 || Command2
```

上面命令的意思是，如果`Command1`命令运行失败，则继续运行`Command2`命令。

## 3.6 `type`

`type`命令用来判断命令的来源。
如果要查看一个命令的所有定义，可以使用`type`命令的`-a`参数。
`type`命令的`-t`参数，可以返回一个命令的类型：别名（alias），关键词（keyword），函数（function），内置命令（builtin）和文件（file）
# 4. 模式扩展
## 4.1 简介

Shell 接收到用户输入的命令以后，会根据空格将用户的输入，拆分成一个个词元（token）。然后，Shell 会扩展词元里面的特殊字符，扩展完成后才会调用相应的命令。

这种特殊字符的扩展，称为模式扩展（globbing）。其中有些用到通配符，又称为通配符扩展（wildcard expansion）。Bash 一共提供八种扩展。

-  波浪线（`~` ）
-  问号（`?`）
-  星号（`*`）
-  方括号（`[]`）
-  大括号（`{}`）
-  变量（`$`）
-  子命令 （\`Command\`或`$(Command)`）
-  算术（`$((...))`）
## 4.2 开启和关闭

关闭Bash扩展

```
$ set -o noglob
# 或者
$ set -f
```

重新打开Bash扩展

```
$ set +o noglob
# 或者
$ set +f
```

>[!IMPORTANT]
>Bash 是先进行扩展，再执行命令。因此，扩展的结果是由 Bash 负责的，与所要执行的命令无关。命令本身并不存在参数扩展，收到什么参数就原样执行。这一点务必需要记住。

## 4.3 波浪线（`~` ）

波浪线`~`会自动扩展成当前用户的主目录。
`~user`表示扩展成用户`user`的主目录。

>[!NOTE]
>如果`~user`的`user`是不存在的用户名，则波浪号扩展不起作用。
>`~+`会扩展成当前所在的目录

## 4.4 问号（`?`）

`?`字符代表文件路径里面的任意单个字符，不包括空字符。

## 4.5 星号（`*`）

`*`字符代表文件路径里面的任意数量的任意字符，包括零个字符。

## 4.6  方括号（`[]`）

 ### 4.6.1 `[...]` `[^...]` `[!...]`
 
 `[aeiou]`可以匹配五个元音字母中的任意一个。
 
`[^abc]`或`[!abc]`表示匹配除了`a`、`b`、`c`以外的字符。

>[!NOTE]
>1.`[`字符，可以放在方括号内，比如`[[aeiou]`
>2.`-`字符，只能放在方括号内部的开头或结尾，比如`[-aeiou]`或`[aeiou-]`

 ### 4.6.2 `[start-end]` `[!start-end]`
 
 方括号扩展有一个简写形式`[start-end]`，表示匹配一个连续的范围。比如，`[a-c]`等同于`[abc]`，`[0-9]`匹配`[0123456789]`;
 否定形式`[!start-end]`，表示匹配不属于这个范围的字符。比如，`[!a-zA-Z]`表示匹配非英文字母的字符。

- `[a-z]`：所有小写字母。
- `[a-zA-Z]`：所有小写字母与大写字母。
- `[a-zA-Z0-9]`：所有小写字母、大写字母与数字。
- `[abc]*`：所有以`a`、`b`、`c`字符之一开头的文件名。
- `program.[co]`：文件`program.c`与文件`program.o`。
- `BACKUP.[0-9][0-9][0-9]`：所有以`BACKUP.`开头，后面是三个数字的文件名。

## 4.7 大括号（`{}`）

### 4.7.1 `{...}`

大括号扩展`{...}`表示分别扩展成大括号里面的所有值，各个值之间使用逗号分隔。比如，`{1,2,3}`扩展成`1 2 3`

```
#在opt目录下创建3个文件夹
mkdir -p /opt/{1,2,3}
```

>[!NOTE]
>大括号内部的逗号前后不能有空格。否则，大括号扩展会失效。
>大括号内部的逗号前后可以没有值，表示空值。
>大括号可以嵌套。
>大括号也可以与其他模式联用，并且总是先于其他模式进行扩展。

### 4.7.2 {start..end}  `{start..end..step}`

大括号扩展有一个简写形式`{start..end}`，表示扩展成一个连续序列。比如，`{a..z}`可以扩展成26个小写英文字母。这种简写形式支持逆序。比如，`{z..a}`可以扩展成26个小写英文字母。

```
echo {{a..z},{z..a}}
echo {001..100}
echo {001..100..2}
echo {a..c}{1..10..2}
echo {a..c}{2..10..2}
```

## 4.8 变量（`$`）

Bash 将美元符号`$`开头的词元视为变量，将其扩展成变量值，详见《Bash 变量》一章。

```
echo $SHELL
```

变量名除了放在美元符号后面，也可以放在`${}`里面。

```
echo ${SHELL}
```

`${!string*}`或`${!string@}`返回所有匹配给定字符串`string`的变量名。

```
echo ${!S*}
```

上面例子中，`${!S*}`扩展成所有以`S`开头的变量名。

## 4.9  子命令 （\`Command\`或`$(Command)`）

`$(...)`可以扩展成另一个命令的运行结果，该命令的所有输出都会作为返回值。
还有另一种较老的语法，子命令放在\`\`反引号之中，也可以扩展成命令的运行结果。
`$(...)`可以嵌套，比如 `echo $(ls -l $(pwd))`。

```
echo `date`
echo $(date)
echo $(ls -l $(pwd))
```

## 4.10 算术（`$((...))`）

`$((...))`可以扩展成整数运算的结果，详见《Bash 的算术运算》一章。

```
echo $((2 + 2))
```

# 5.  特殊字符

## 5.1  反斜杠`\`

1. 需要进行转义的特殊字符
	-  `$`
	-  `&`
	-  `*`
	-  `\`
	-  `` ` ``

1. 不可打印的字符
	- `\a`：响铃
	- `\b`：退格
	- `\n`：换行
	- `\r`：回车
	- `\t`：制表符


## 5.2 单引号 `'`

单引号用于保留字符的字面含义，各种特殊字符在单引号里面，都会变为普通字符，比如星号（`*`）、美元符号（`$`）、反斜杠（`\`）等。

单引号使得 Bash 扩展、变量引用、算术运算和子命令，都失效了。如果不使用单引号，它们都会被 Bash 自动扩展。

>[!IMPORTANT]
>由于反斜杠在单引号里面变成了普通字符，所以如果单引号之中，还要使用单引号，不能使用转义，需要在外层的单引号前面加上一个美元符号（`$`），然后再对里层的单引号转义。
>例如
>`echo $'it\'s'`
>更合理的做法`echo "it's"`


## 5.3 双引号`"`

双引号比单引号宽松，大部分特殊字符在双引号里面，都会失去特殊含义，变成普通字符。

- 美元符号（`$`）
- 反引号（`` ` ``）
- 反斜杠（`\`）


